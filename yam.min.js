(function(d,g){var f=d.jQuery||d.Cowboy||(d.Cowboy={}),e;f.throttle=e=function(m,l,a,b){var c,n=0;if(typeof l!=="boolean"){b=a;a=l;l=g}function k(){var p=this,h=+new Date()-n,q=arguments;function i(){n=+new Date();a.apply(p,q)}function j(){c=g}if(b&&!c){i()}c&&clearTimeout(c);if(b===g&&h>m){i()}else{if(l!==true){c=setTimeout(b?j:i,b===g?m-h:m)}}}if(f.guid){k.guid=a.guid=a.guid||f.guid++}return k};f.debounce=function(c,b,a){return a===g?e(c,b,false):e(c,a,b!==false)}})(this);(function(){(function(e,b){var d,f,a,c;c="yam";a=b.document;f={hover_delay:1000,window_min_width:640,hover_animations:{"in":100,out:100},layout_vertical_at:3,selectors:[["self","> li"],["> ul, > ol","> li"]],callbacks:{mouseenter:void 0,mouseleave:void 0,click:void 0},click_events:"click, touchend",is_active:function(g){return g.hasClass("active")}};d=(function(){function g(i,h){this.element=i;this.options={};this.enabled=true;this.menus=[];this.active=[];this.options=e.extend({},f,h);this.init()}g.prototype.init=function(){var h;h=this;e(this.element).addClass("yam-menu");this.initLayouts();if(e("body").width()<=h.options.window_min_width&&h.enabled){return h._disable()}};g.prototype.initLayouts=function(){var i,h;i=this;this._walkMenu(e(this.element),function(l,k,j,n,m){k.addClass("yam-"+l._getLayout(n));k.data("yam-level",n);if(l.menus[n]===void 0){l.menus[n]=[]}l.menus[n].push(k);if(l._getLayout(n)==="horizontal"){if(l.options.is_active(m)){l.active[n]=k;m.addClass("yam-active")}}j.each(function(o,p){e(p).addClass("yam-item");l.manageClick(e(p));if(l._getLayout(n)==="vertical"){return e(p).css("min-width",l._getElementWidth(e(p)))}});if(k!==m){l.manageHover(m,k);if(j.length>0){return m.addClass("yam-parent")}}});h=parseInt(e(this.element).css("margin-bottom"),10);e(this.element).data("yam-margin-bottom",h);e.each(this.menus,function(j,m){var k;k=0;e.each(m,function(n,o){var p,l;p=false;if(i.active[j]!==void 0){if(i.active[j]===o){p=true}}if(o[0]===i.element){p=true}if(!p){e(o).hide()}if(o[0]!==i.element&&o.hasClass("yam-horizontal")){l=i._getElementHeight(o);if(l>k){return k=l}}});return h=h+k});e(this.element).css("margin-bottom",h);e.each(this.active,function(j,k){if(k!==void 0){return i.checkHeightForMenu(k)}});return e(b).resize(e.debounce(50,function(){e.each(i.active,function(j,k){if(k!==void 0){return i.checkHeightForMenu(k)}});h=e(i.element).data("yam-margin-bottom");e.each(i.menus,function(j,m){var k;k=0;e.each(m,function(n,o){var l;if(o[0]!==i.element&&o.hasClass("yam-horizontal")){l=i._getElementHeight(o);if(l>k){return k=l}}});return h=h+k});e(i.element).css("margin-bottom",h);if(e("body").width()<=i.options.window_min_width&&i.enabled){return i._disable()}else{if(e("body").width()>i.options.window_min_width&&!i.enabled){return i._enable()}}}))};g.prototype.checkHeightForMenu=function(i){var h,j;j=i.data("yam-level");if(j!==null){h=this._getElementHeight(this.menus[j-1][0]);if(this._getLayout(j)==="horizontal"){return i.css("top",h)}}};g.prototype.positionSubmenu=function(j,m){var i,l,h,k;l=j.data("yam-level");if(this._getLayout(l)==="vertical"){h=this._getElementWidth(j,true);i=this._getElementWidth(e("body"));j.css("top","auto");j.css("bottom","auto");j.css("left","auto");j.css("right","auto");if(this._getLayout(l-1)==="vertical"){k=this._getElementWidth(m,true);if(i>(k+h+m.offset().left)){j.css("right",-h);return j.css("top",m.position().top)}else{if(h<m.offset().left){j.css("left",-h);return j.css("top",m.position().top)}else{return j.css("bottom",-this._getElementHeight(j,true))}}}else{if(i<(h+m.offset().left)){j.css("left","auto");return j.css("right",0)}}}};g.prototype.manageClick=function(h){var i;i=this;if(Modernizr.touch){h.bind(this.options.click_events,function(j){var k;if(!h.hasClass("yam-active")){j.preventDefault();k={obj:i,element:h};i._manageMouseEnter(h,h.find(".yam-horizontal, .yam-vertical").first());h.addClass("yam-active");return e(b).bind(i.options.click_events,k,i.windowClickHandler)}})}if(e.isFunction(this.options.callbacks.click)){return h.bind(i.options.click_events,this.options.callbacks.click)}};g.prototype.windowClickHandler=function(i){var h;if(e(i.data.element).closest(".yam-menu")[0]!==e(i.target).closest(".yam-menu")[0]){h=this;return setTimeout((function(){e(i.data.element).removeClass("yam-active");i.data.obj._manageMouseLeave(e(i.data.element),e(i.data.obj.element));e(i.data.obj.element).find(".yam-active").removeClass("yam-active");return e(b).unbind(i.data.obj.options.click_events,h.windowClickHandler)}),0)}};g.prototype.manageHover=function(h,j){var i;i=this;if(e.inArray(j,this.active)>0){h.mouseenter(function(k){h.siblings().find(".yam-hover").each(function(l,m){return i._hideMenu(e(m))});return j.show()});return}h.mouseenter(function(k){clearTimeout(h.data("yam-mouseleave-timer"));return i._manageMouseEnter(h,j)});return h.mouseleave(function(k){var l;l=setTimeout((function(){return i._manageMouseLeave(h,j)}),i.options.hover_delay);return h.data("yam-mouseleave-timer",l)})};g.prototype._manageMouseEnter=function(h,j){var i;if(!this.isMenuHover(j)){i=this;h.siblings().find(".yam-hover").each(function(k,l){return i._hideMenu(e(l))});if(this.active[j.data("yam-level")]!==void 0){this.active[j.data("yam-level")].hide()}this._showMenu(j,h);if(e.isFunction(this.options.callbacks.mouseenter)){return this.options.callbacks.mouseenter(event,h)}}};g.prototype._manageMouseLeave=function(h,j){var i;this._hideMenu(j);i=this;j.find(".yam-horizontal, .yam-vertical").each(function(k,l){return i._hideMenu(e(l))});if(this.active[j.data("yam-level")]!==void 0){this.active[j.data("yam-level")].show()}if(e.isFunction(this.options.callbacks.mouseleave)){return this.options.callbacks.mouseleave(event,h)}};g.prototype._enable=function(){this.enabled=true;return e(this.element).show()};g.prototype._disable=function(){this.enabled=false;return e(this.element).hide()};g.prototype._showMenu=function(i,h){if(!this.isMenuHover(i)){this.checkHeightForMenu(i,h);this.positionSubmenu(i,h);if(i.hasClass("yam-horizontal")){i.fadeIn(this.options.hover_animations["in"])}else{i.slideDown(this.options.hover_animations["in"])}return i.addClass("yam-hover")}};g.prototype._hideMenu=function(h){if(this.isMenuHover(h)){if(h.hasClass("yam-horizontal")){h.fadeOut(this.options.hover_animations.out)}else{h.slideUp(this.options.hover_animations.out)}return h.removeClass("yam-hover")}};g.prototype.isMenuHover=function(h){return h.hasClass("yam-hover")};g.prototype._walkMenu=function(p,i,h,n){var m,k,j,o,l;if(h==null){h=0}l=this;o=this._getSelector(h)[0];j=this._getSelector(h)[1];if(o==="self"){k=p}else{k=p.find(o)}if(k===void 0||k.length===0){return}m=k.find(j);if(m===void 0||m.length===0){return}i(this,k,m,h,p);return m.each(function(q,r){return l._walkMenu(e(r),i,h+1,n)})};g.prototype._getSelector=function(h){if(h>=this.options.selectors.length){return this.options.selectors[this.options.selectors.length-1]}else{return this.options.selectors[h]}};g.prototype._getLayout=function(h){if(h>=(this.options.layout_vertical_at-1)){return"vertical"}else{return"horizontal"}};g.prototype._getElementWidth=function(i,h){if(h==null){h=false}if(!h){return i.outerWidth()}else{return i.outerWidth()+parseInt(i.css("margin-left"),10)+parseInt(i.css("margin-right"),10)}};g.prototype._getElementHeight=function(i,h){if(h==null){h=false}if(!h){return i.outerHeight()}else{return i.outerHeight()+parseInt(i.css("margin-top"),10)+parseInt(i.css("margin-bottom"),10)}};return g})();return e.fn[c]=function(g){return this.each(function(){if(!e.data(this,"plugin_"+c)){return e.data(this,"plugin_"+c,new d(this,g))}})}})(jQuery,window)}).call(this);